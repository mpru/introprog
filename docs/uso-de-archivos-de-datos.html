<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>6 Uso de archivos de datos | Introducción a la Programación</title>
<meta name="author" content="Mgs. Lic. Marcos Prunello (Prof. Tit. Ord.)">
<meta name="description" content="6.1 Introducción Como hemos visto, los programas usan variables para guardar información: datos de entrada, resultados calculados, valores intermedios, etc. Sin embargo, la información guardada en...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="6 Uso de archivos de datos | Introducción a la Programación">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Introducción Como hemos visto, los programas usan variables para guardar información: datos de entrada, resultados calculados, valores intermedios, etc. Sin embargo, la información guardada en...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="6 Uso de archivos de datos | Introducción a la Programación">
<meta name="twitter:description" content="6.1 Introducción Como hemos visto, los programas usan variables para guardar información: datos de entrada, resultados calculados, valores intermedios, etc. Sin embargo, la información guardada en...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Guía de estudio - Lic. en Estadística - FCEyE - UNR">Introducción a la Programación</a>:
        <small class="text-muted">Guía de estudio - Lic. en Estadística - FCEyE - UNR</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenida</a></li>
<li><a class="" href="introducci%C3%B3n-a-la-programaci%C3%B3n.html"><span class="header-section-number">1</span> Introducción a la Programación</a></li>
<li><a class="" href="objetos-y-operadores.html"><span class="header-section-number">2</span> Objetos y operadores</a></li>
<li><a class="" href="estructuras-de-control.html"><span class="header-section-number">3</span> Estructuras de control</a></li>
<li><a class="" href="descomposici%C3%B3n-algor%C3%ADtmica.html"><span class="header-section-number">4</span> Descomposición algorítmica</a></li>
<li><a class="" href="estructuras-de-datos.html"><span class="header-section-number">5</span> Estructuras de datos</a></li>
<li><a class="active" href="uso-de-archivos-de-datos.html"><span class="header-section-number">6</span> Uso de archivos de datos</a></li>
<li><a class="" href="otros-t%C3%B3picos.html"><span class="header-section-number">7</span> Otros tópicos</a></li>
<li><a class="" href="bibliograf%C3%ADa.html">Bibliografía</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="uso-de-archivos-de-datos" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Uso de archivos de datos<a class="anchor" aria-label="anchor" href="#uso-de-archivos-de-datos"><i class="fas fa-link"></i></a>
</h1>
<div id="introducción" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>Como hemos visto, los programas usan variables para guardar información: datos de entrada, resultados calculados, valores intermedios, etc. Sin embargo, la información guardada en las variables es efímera. Cuando los programas paran de correr, el valor almacenado en las variables se pierde. En muchas ocasiones, es necesario guardar información de una forma más permanente.</p>
<p>En estos casos, el enfoque usual es recolectar la información en un todo lógicamente cohesivo y guardarlo en un medio permanente que generalmente se graba en el disco rígido de la máquina, es decir, en un archivo. Un <strong>archivo</strong> o <strong>fichero</strong> es un conjunto de información sobre un mismo tema tratado como una unidad de almacenamiento y organizado de forma estructurada para la búsqueda de un dato individual. Los archivos pueden contener instrucciones de programas o información creada o usada por un programa. Todos los objetos de datos permanentes que guardamos en nuestra computadora (documentos, juegos, programas ejecutables, código, etc.) son guardados en la forma de archivos.</p>
<p>Un archivo se identifica con un <strong>nombre</strong>, seguido por un <em>punto</em> y una <strong>extensión</strong>, la cual es un sufijo empleado para indicar características de su contenido, el uso pretendido o el software con el cual puede ser empleado. Por ejemplo, un archivo que se llama <em>planilla.xlsx</em> es una hoja de cálculo de Excel o un archivo llamado <em>codigo.R</em> es un script de código de R.</p>
<div id="registros-campos-claves-y-bases-de-datos" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Registros, campos, claves y bases de datos<a class="anchor" aria-label="anchor" href="#registros-campos-claves-y-bases-de-datos"><i class="fas fa-link"></i></a>
</h3>
<p>En esta asignatura nos limitaremos a trabajar con archivos que guardan información de forma tabular, en los que la unidad elemental que los compone es un <strong>registro</strong>, es decir, una colección de información relativa a una misma entidad. En general, cada registro de un mismo archivo tiene la misma estructura que los demás. Los datos individuales sobre dicha entidad se organizan en <strong>campos</strong>. Un <strong>campo</strong> es la mínima unidad de información de un registro.</p>
<p>Para ejemplificar, trabajaremos con un archivo llamado <em>mundiales.txt</em> que tiene datos sobre todos los mundiales de fútbol de la FIFA, incluyendo el del año 2022, en el cual nuestra selección argentina conquistó su tercer título. Cada fila del conjunto de datos corresponde a un país y cada columna hace referencia a las siguientes variables<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Los partidos definidos en tiempo complementario se cuentan como victorias y derrotas, mientras que los partidos definidos por tandas de penales se cuentan como empates.&lt;/p&gt;"><sup>25</sup></a>:</p>
<pre><code>ARCHIVO: mundiales.txt
Campo 1 - seleccion: nombre del país, tipo carácter
Campo 2 - continente: continente al que pertenece el país, tipo carácter
Campo 3 - participaciones: cantidad de mundiales jugados, tipo numérico
Campo 4 - pg: cantidad de partidos ganados, tipo numérico
Campo 5 - pe: cantidad de partidos empatados, tipo numérico
Campo 6 - pp: cantidad de partidos perdidos, tipo numérico
Campo 7 - gf: cantidad de goles a favor, tipo numérico
Campo 8 - gf: cantidad de goles en contra, tipo numérico
Campo 9 - titulo: cantidad de mundiales ganados, tipo numérico</code></pre>
<p>Este archivo tiene 80 registros, ya que son 80 países los que han disputado algún mundial a lo largo de la historia. Los primeros registros lucen así:</p>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="15%">
<col width="16%">
<col width="23%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="7%">
<col width="7%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">seleccion</th>
<th align="center">continente</th>
<th align="center">participaciones</th>
<th align="center">pg</th>
<th align="center">pe</th>
<th align="center">pp</th>
<th align="center">gf</th>
<th align="center">gc</th>
<th align="center">titulos</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Brasil</td>
<td align="center">América</td>
<td align="center">22</td>
<td align="center">76</td>
<td align="center">19</td>
<td align="center">19</td>
<td align="center">237</td>
<td align="center">108</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">Alemania</td>
<td align="center">Europa</td>
<td align="center">20</td>
<td align="center">68</td>
<td align="center">21</td>
<td align="center">23</td>
<td align="center">232</td>
<td align="center">130</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">Argentina</td>
<td align="center">América</td>
<td align="center">18</td>
<td align="center">47</td>
<td align="center">17</td>
<td align="center">24</td>
<td align="center">152</td>
<td align="center">101</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">Italia</td>
<td align="center">Europa</td>
<td align="center">18</td>
<td align="center">45</td>
<td align="center">21</td>
<td align="center">17</td>
<td align="center">128</td>
<td align="center">77</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">Francia</td>
<td align="center">Europe</td>
<td align="center">16</td>
<td align="center">39</td>
<td align="center">14</td>
<td align="center">20</td>
<td align="center">136</td>
<td align="center">85</td>
<td align="center">2</td>
</tr>
</tbody>
</table></div>
<p><br></p>
<p>Un campo está caracterizado por el tipo de datos que almacena (carácter, numérico, lógico) y en algunos contextos es necesario precisar su longitud (por ejemplo, cantidad de caracteres admitidos como máximo en los datos del campo). Algunos lenguajes, como R, admiten trabajar con campos de longitud variable (sin necesidad de que sea especificada con anticipación).</p>
<p>En el contexto del análisis de datos, cada columna o <em>campo</em> en este tipo de archivos puede representar una variable observada sobre los individuos o unidades de interés, los cuales se encuentran dispuestos en las sucesivas filas.</p>
<p>Generalmente suele ser necesario identificar de manera única a cada registro de un archivo. Para esto suele considerarse a uno de los campos del archivo como el <strong>campo clave</strong> o, más sencillamente, <strong>clave</strong>. La <strong>clave</strong> o <em>key</em> es el campo que identifica inequívocamente a cada registro, permitiendo diferenciarlo del resto, como podría ser el nombre de la selección en el ejemplo anterior. En ocasiones donde no hay un campo <em>clave</em> es posible identificar un registro a través de la combinación de los valores presentes en más de uno de los campos.</p>
<p>Por último, cabe mencionar que llamamos <strong>base de datos</strong> a un conjunto de archivos que contienen datos relacionados entre sí, vinculados mediante sistemas complejos que enlazan las claves de uno y otro archivo y que pueden ser consultados mediante el uso de software especializado. Por eso, cuando trabajamos con los datos almacenados en un único archivo, es conveniente referirse a los mismos como “conjunto de datos” y no como “base de datos”.</p>
</div>
<div id="organización-de-archivos" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> Organización de archivos<a class="anchor" aria-label="anchor" href="#organizaci%C3%B3n-de-archivos"><i class="fas fa-link"></i></a>
</h3>
<p>Existen distintos tipos de organización de los archivos según la forma en la que se pueda acceder a cada uno de sus registros:</p>
<ul>
<li>
<p><strong>Organización secuencial</strong></p>
<p>Los registros se encuentran en cierto orden que debe ser respetado para la lectura de los mismos. Para leer el registro situado en la posición <em>n</em>, el programa previamente tiene que pasar por los <em>n-1</em> registros que ocupan las posiciones anteriores.</p>
<p>Los archivos de tipo secuencial en general ocupan menos memoria y suelen ser utilizados para guardar contenidos que sufren pocas modificaciones. Los registros se graban consecutivamente en el soporte que los aloja (por ejemplo, en el disco). El orden físico con el que fueron escritos los registros coincide con el orden de lectura de los mismos.</p>
<p>Los registros pueden leerse uno por uno hasta llegar al final del archivo, donde se indica de alguna manera el fin del mismo, muchas veces a través de un caracter especial como un asterisco o de una línea en blanco. Esta marca generalmente se conoce como <em>EOF</em> (<em>end of file</em>). La mayoría de los lenguajes de programación disponen de una función lógica que devuelve un valor <code>VERDADERO</code> cuando se alcanza el final del archivo.</p>
<!-- Los archivos de tipo secuencial en general ocupan menos memoria, su uso no requiere establecer con anterioridad la cantidad de registros a almacenar y suelen ser utilizados para guardar contenidos que sufren pocas modificaciones. -->
</li>
<li>
<p><strong>Organización directa</strong></p>
<p>Son archivos que están organizados de manera que se pueda acceder de forma directa a cada registro mediante su posición en el soporte físico que lo contiene, sin tener que pasar secuencialmente por los registros anteriores. Poseen la ventaja de brindar un acceso rápido a la información y la posibilidad de leer y escribir registros en cualquier posición y orden.</p>
<p>Se puede mencionar como desventaja de este tipo de organización el hecho de que requiere la programación de la forma de identificar la posición de un registro a partir de alguno de los valores de sus campos, generalmente, la <em>clave</em>. Esto se hace mediante un algoritmo de transformación de la clave (llamado <em>hash function</em>) que a partir de la misma devuelve la dirección del registro en el soporte físico. El archivo debe diseñarse teniendo en cuenta de antemano una cantidad total de registros fija.</p>
</li>
<li>
<p><strong>Organización indexada</strong></p>
<p>Los archivos están estructurados de manera que los registros se pueden localizar sin pasar por los anteriores, consultando en una tabla adicional de índices la zona del archivo donde se encuentra el registro buscado. Esto permite localizar un registro por medio de su clave o del valor de algún campo en particular.</p>
<p>Para imaginarnos esto, podemos pensar que un diccionario es un ejemplo de un archivo indexado, ya que podemos encontrar la región donde se encuentra un registro (palabra) mediante el índice de letras. Si queremos buscar el término “programación” en un diccionario, no recorremos todas las palabras del mismo desde la “A” hasta encontrar el término de interés, sino que buscamos en el índice en qué página del diccionario se encuentra la “P” y comenzamos una búsqueda secuencial desde la misma.</p>
<p>Un archivo indexado, entonces, cuenta en realidad con dos archivos, uno de índices (que se recorre de forma secuencial) y otro con los registros propiamente dichos. Posee la ventaja de brindar un rápido acceso a los registros, pero con el costo de utilizar espacio adicional para la tabla de índices.</p>
</li>
</ul>
<p>La organización más sencilla y más comúnmente empleada es la <strong>secuencial</strong>, aunque en algunos casos puede no ser la más eficiente. Si bien no todos los lenguajes de programación permiten el trabajo con archivos indexados o de organización directa, todos pueden manejar archivos secuenciales.</p>
<p>En este curso no profundizaremos en esta distinción y trabajaremos con archivos guardados como documentos de Excel (extensión <em>.xlsx</em>) o archivos de texto (extensión <em>.txt</em> o <em>.csv</em>), los cuales siguen una organización secuencial.</p>
<p>Un <strong>archivo de texto</strong> (también conocido como <em>texto llano</em> o <em>texto simple</em>) es un archivo informático que contiene únicamente texto formado por una secuencia ordenada de caracteres. El texto almacenado en este tipo de archivo carece de cualquier tipo de formato tipográfico (negrita, cursiva, colores, subrayado, fuente, etc.), lo cual permite que una gran variedad de programas pueda leer y editar el contenido. Cada renglón en el archivo de texto es un registro y los distintos campos suelen estar señalizados con tabulaciones (archivos <em>.txt</em>, como el que usaremos de ejemplo, <em>mundiales.txt</em>) o separados por comas o punto y comas (archivos <em>.csv</em>).</p>
<p>Los archivos de texto están compuestos por caracteres ordinarios, como las letras, números y signos de puntuación, y por caracteres especiales que indican, por ejemplo, saltos de línea (<code>\n</code>) y tabulaciones (<code>\t</code>). Pero como en realidad las computadoras solamente entienden números, cada carácter es codificado internamente con una representación numérica binaria, que nosotros nunca llegamos a ver. Distintas maneras de hacer esta representación dan lugar a diferentes formatos de codificación de caracteres (como <em>ASCII</em>, <em>ISO-8859-1</em> o <em>UTF-8</em>). Si en alguna oportunidad abrimos un archivo y nos percatamos que caracteres como la “ñ” o las tildes han sido reemplazadas por otros produciendo un aspecto “raro”, significa que el archivo ha sido abierto empleando una codificación diferente de la que se utilizó al crear el archivo. La solución para este problema es muy sencilla, sólo hay que cambiar la opción de codificación a la hora de guardar o de abrir el archivo.</p>
</div>
<div id="operaciones-sobre-archivos" class="section level3" number="6.1.3">
<h3>
<span class="header-section-number">6.1.3</span> Operaciones sobre archivos<a class="anchor" aria-label="anchor" href="#operaciones-sobre-archivos"><i class="fas fa-link"></i></a>
</h3>
<p>El uso de archivos en programación es muy importante ya que nos permite leer datos para hacer algún tipo de procesamiento y también guardar resultados obtenidos. El sistema operativo de la computadora es el que se encarga de manipular los archivos para que podamos leerlos o escribir en ellos, pero debemos aprender las sentencias que el lenguaje de programación elegido utiliza para encargarle esas tareas al sistema operativo. Los procedimientos básicos que los programas pueden llevar a cabo sobre los distintos tipos de archivos son:</p>
<ul>
<li><p><strong>Creación de un archivo</strong>: para que un archivo pueda ser utilizado, antes tiene que existir, obviamente. Una vez que el archivo de datos fue creado y existe, se pueden hacer con él las restantes operaciones. En la mayoría de las aplicaciones que veremos, tendremos archivos que han sido creados con anterioridad y ya tienen registros, por lo cual usaremos pocas veces esta acción, pero eventualmente crearemos nuevos archivos para guardar nuevas versiones del conjunto de datos o para guardar resultados en otro tipo de documento.</p></li>
<li><p><strong>Apertura de un archivo</strong>: para que un programa pueda operar sobre un archivo, la primera acción que debe realizar es la <strong>apertura</strong> del mismo, que incluye la identificación del archivo a utilizar y el modo (lectura o escritura). Esto hace que el sistema operativo establezca una <em>conexión</em> con el archivo que mientras se mantenga activa permitirá la lectura y escritura de registros en el mismo. Dependiendo del lenguaje de programación o de las subsiguientes operaciones a realizar, en algunos casos la apertura tiene que ser indicada con alguna instrucción de manera explícita y en otros, no.</p></li>
<li><p><strong>Lectura de registros en un archivo</strong>: la <strong>lectura</strong> consiste en transferir información del archivo a la memoria principal usada por el programa. En los archivos de organización secuencial, los registros se leen uno por uno, es decir, línea por línea, hasta llegar al final del archivo. Sin embargo, en la aplicaciones que nos interesan, el software se encarga de leer automáticamente todos los registros y almacenarlos en alguna estructura de datos especializada que definamos en el ambiente de trabajo.</p></li>
<li><p><strong>Escritura en un archivo</strong>: la <strong>escritura</strong> es la transferencia de información guardada en las variables del programa al archivo.</p></li>
<li><p><strong>Cierre de un archivo</strong>: cuando un programa no vaya a acceder más a un archivo, es necesario indicarlo a través del <strong>cierre</strong> del mismo, para que se interrumpa la conexión establecida por el sistema operativo. Esto hace que se liberen memoria y recursos del sistema, se prevenga la corrupción de los datos y se exprese explícitamente que ya no se hará más uso del mismo. En algunos lenguajes o para determinadas tareas, esto puede no ser necesario.</p></li>
<li>
<p><strong>Otras operaciones</strong>: ptras operaciones que se pueden realizar sobre los archivos, en base a combinaciones de las anteriores, incluyen a las acciones de:</p>
<ul>
<li>
<em>Actualización</em>: añadir (dar de alta), modificar o eliminar (dar de baja) algún registro.</li>
<li>
<em>Clasificación</em>: reubicar los registros de tal forma que queden ordenados por algún campo determinado.</li>
<li>
<em>Fusión o mezcla</em>: combinar dos o más archivos para formar uno nuevo.</li>
<li>
<em>Partición</em>: subdividir los registros por el valor que toman en algún campo para generar más de un archivo.</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="lectura-de-los-registros-del-archivo" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Lectura de los registros del archivo<a class="anchor" aria-label="anchor" href="#lectura-de-los-registros-del-archivo"><i class="fas fa-link"></i></a>
</h2>
<p>Ya hemos mencionado que R se organiza mediante un sistema de paquetes, algunos de los cuales vienen instalados con la distribución básica de R, mientras que otros deben ser instalados si tenés el particular interés de usarlos. R Base trae muchas funciones útiles para la importación de datos, así como para las subsiguientes tareas de manejo, transformación y resumen. Sin embargo, en este curso aprenderemos a emplear una familia de paquetes conocida como <a href="https://www.tidyverse.org"><strong>tidyverse</strong></a>, creados para la manipulación, exploración y visualización de datos con un diseño, estructuras y reglas de uso en común, que resultan muy amigables para programar.</p>
<div class="inline-figure"><img src="images/06_archivos/tidyverse.png" width="70%" style="display: block; margin: auto;"></div>
<p>Instalamos esta colección de paquetes con:</p>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></code></pre></div>
<p>Lo anterior se realiza una sola vez. Luego, cada vez que queramos usar este sistema, usamos <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> para que queden a nuestra disposición las funciones provistas por los paquetes más importantes de esta gran familia:</p>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p>El <em>tidyverse</em> provee una función de uso muy sencillo para leer datos guardados en un archivo de texto con campos separados por tabulaciones, como es el caso de <code>mundiales.txt</code>. En <a href="https://github.com/mpru/introprog/tree/master/archivos">este enlace</a> o en el aula virtual podrás encontrar el archivo de datos.</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"mundiales.txt"</span><span class="op">)</span></code></pre></div>
<p>Si tenemos que importar otro tipo de archivo (por ejemplo, de Excel o de texto separado con comas) y no nos acordamos cuál es la función que permite hacerlo, podemos recurrir al menú de importación de datos mediante el botón <code>Import Dataset</code> en el panel <code>Environment</code> de RStudio (arriba a la derecha). Ahí podremos elegir distintas opciones para la importación y automáticamente se generará y ejecutará el código de R necesario, el cual debemos copiar y pegar en nuestro <em>script</em> para dejar sentado cómo se realizó la importación.</p>
<div class="inline-figure"><img src="images/06_archivos/importar1.png" width="30%" style="display: block; margin: auto;"></div>
<p>Una vez completado este paso, en el ambiente podremos ver listado un nuevo objeto llamado <code>datos</code>, ya que ese es el nombre que elegimos como identificador para el conjunto de datos devuelto por la función <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code>. Allí también vemos una breve descripción que nos dice que <code>datos</code> tiene 80 observaciones (registros) de 9 variables (campos). Si hacemos clic sobre el nombre del objeto se abrirá una pestaña para que podamos explorar su contenido. Entonces… ¿qué tipo de objeto es <code>datos</code>?:</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" </code></pre>
<p>Hasta ahora habíamos trabajado con tres tipos de datos básicos: numérico, carácter y lógico, y habíamos visto que con los mismos podíamos crear estructuras de datos como vectores, matrices o listas. Como indica la salida anterior, el objeto <code>datos</code> es de tipo <em>data.frame</em>, lo cual significa que es una estructura de datos bidimensional (como una matriz) en la cual cada fila representa a un registro y cada columna representa a uno de los campos del archivo, pudiendo entonces almacenar valores de distinto tipo en cada una de ellas (a diferencia de los arreglos, cuyos valores son todos homogéneos)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Internamente, un &lt;em&gt;data.frame&lt;/em&gt; es sencillamente una lista, compuesta por vectores de distinto tipo que tienen todos el mismo largo y que se organizan como columnas. Además, esta lista es almacenada junto con cierta información adicional (&lt;em&gt;atributos&lt;/em&gt;) que nos permiten manipularla como una estructura tabular.&lt;/p&gt;"><sup>26</sup></a>.</p>
<p>Existen algunas funciones de R que nos permiten explorar el contenido de un <em>data.frame</em>:</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra los nombres de las columnas (campos del archivo)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>[1] "seleccion"       "continente"      "participaciones" "pg"             
[5] "pe"              "pp"              "gf"              "gc"             
[9] "titulos"        </code></pre>
<div class="sourceCode" id="cb640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra la "estructura" interna del dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>spc_tbl_ [80 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ seleccion      : chr [1:80] "Brasil" "Alemania" "Argentina" "Italia" ...
 $ continente     : chr [1:80] "América" "Europa" "América" "Europa" ...
 $ participaciones: num [1:80] 22 20 18 18 16 16 16 11 14 14 ...
 $ pg             : num [1:80] 76 68 47 45 39 32 31 30 25 21 ...
 $ pe             : num [1:80] 19 21 17 21 14 22 17 14 13 10 ...
 $ pp             : num [1:80] 19 23 24 17 20 20 19 11 21 20 ...
 $ gf             : num [1:80] 237 232 152 128 136 104 108 96 89 69 ...
 $ gc             : num [1:80] 108 130 101 77 85 68 75 52 76 74 ...
 $ titulos        : num [1:80] 5 4 3 4 2 1 1 0 2 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   seleccion = col_character(),
  ..   continente = col_character(),
  ..   participaciones = col_double(),
  ..   pg = col_double(),
  ..   pe = col_double(),
  ..   pp = col_double(),
  ..   gf = col_double(),
  ..   gc = col_double(),
  ..   titulos = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
<div class="sourceCode" id="cb642"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra la cantidad de filas y columnas</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 80  9</code></pre>
<div class="sourceCode" id="cb644"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra la cantidad de filas</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 80</code></pre>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra la cantidad de columnas</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 9</code></pre>
<div class="sourceCode" id="cb648"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra los primeros registros</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 6 × 9
  seleccion  continente participaciones    pg    pe    pp    gf    gc titulos
  &lt;chr&gt;      &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 Brasil     América                 22    76    19    19   237   108       5
2 Alemania   Europa                  20    68    21    23   232   130       4
3 Argentina  América                 18    47    17    24   152   101       3
4 Italia     Europa                  18    45    21    17   128    77       4
5 Francia    Europe                  16    39    14    20   136    85       2
6 Inglaterra Europa                  16    32    22    20   104    68       1</code></pre>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra los últimos registros</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 6 × 9
  seleccion     continente participaciones    pg    pe    pp    gf    gc titulos
  &lt;chr&gt;         &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 Emiratos Ára… asia                     1     0     0     3     2    11       0
2 China         asia                     1     0     0     3     0     9       0
3 Canadá        América                  2     0     0     6     2    12       0
4 Haití         América                  1     0     0     3     2    14       0
5 R. D. del Co… África                   1     0     0     3     0    14       0
6 El Salvador   América                  2     0     0     6     1    22       0</code></pre>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Muestra un resumen de cada campo</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></code></pre></div>
<pre><code>  seleccion          continente        participaciones        pg        
 Length:80          Length:80          Min.   : 1.000   Min.   : 0.000  
 Class :character   Class :character   1st Qu.: 1.750   1st Qu.: 0.750  
 Mode  :character   Mode  :character   Median : 4.500   Median : 4.000  
                                       Mean   : 6.112   Mean   : 9.375  
                                       3rd Qu.: 9.000   3rd Qu.:12.000  
                                       Max.   :22.000   Max.   :76.000  
       pe              pp               gf            gc        
 Min.   : 0.00   Min.   : 1.000   Min.   :  0   Min.   :  2.00  
 1st Qu.: 1.00   1st Qu.: 3.000   1st Qu.:  4   1st Qu.: 11.00  
 Median : 3.00   Median : 7.500   Median : 15   Median : 24.50  
 Mean   : 5.35   Mean   : 9.375   Mean   : 34   Mean   : 34.00  
 3rd Qu.: 8.00   3rd Qu.:14.250   3rd Qu.: 43   3rd Qu.: 49.25  
 Max.   :22.00   Max.   :28.000   Max.   :237   Max.   :130.00  
    titulos     
 Min.   :0.000  
 1st Qu.:0.000  
 Median :0.000  
 Mean   :0.275  
 3rd Qu.:0.000  
 Max.   :5.000  </code></pre>
<p>Un <em>data.frame</em> puede ser indexado de la misma forma empleada con matrices, por ejemplo:</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Mostrar las filas 3 y 4, columnas 1 y 3</span>
<span class="va">datos</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  seleccion participaciones
  &lt;chr&gt;               &lt;dbl&gt;
1 Argentina              18
2 Italia                 18</code></pre>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Mostrar las filas 3 y 4, columnas "seleccion" y "participaciones"</span>
<span class="va">datos</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"seleccion"</span>, <span class="st">"participaciones"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  seleccion participaciones
  &lt;chr&gt;               &lt;dbl&gt;
1 Argentina              18
2 Italia                 18</code></pre>
<p>Para hacer referencia exclusivamente a una variable dentro del <em>data.frame</em>, usamos el nombre del conjunto de datos, seguido por el operador <code>$</code> y el nombre de la variable, por ejemplo:</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span><span class="op">$</span><span class="va">titulos</span></code></pre></div>
<pre><code> [1] 5 4 3 4 2 1 1 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
[39] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
[77] 0 0 0 0</code></pre>
<p>Lo anterior resulta en un vector, con el que se pueden hacer operaciones como buscar el valor máximo si queremos saber cuál es la cantidad máxima de títulos alcanzada:</p>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">titulos</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 5</code></pre>
<p>Si bien en los ejemplos anteriores vemos que en muchos aspectos los <em>data.frame</em>s son similares a las matrices, a partir de ahora vamos a ver cómo utilizar funciones que fueron especialmente pensadas para ayudarnos a transformar y explorar los conjuntos de datos que están guardados en objetos de tipo <em>data.frame</em> y que simplifican muchas tareas relacionadas al análisis de datos.</p>
</div>
<div id="manejo-de-datos" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Manejo de datos<a class="anchor" aria-label="anchor" href="#manejo-de-datos"><i class="fas fa-link"></i></a>
</h2>
<div id="editar-o-crear-nuevas-variables" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Editar o crear nuevas variables<a class="anchor" aria-label="anchor" href="#editar-o-crear-nuevas-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Es muy común tener que modificar una variable existente o añadir una nueva, la cual puede depender de algún cálculo realizado a partir de otras columnas presentes en el dataset. Para cualquiera de estas actividades que implican <em>modificar</em> o <em>mutar</em> el dataset, emplearemos la función <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. Vamos a calcular la cantitad total que cada selección ha jugado en los mundiales a lo largo de toda la historia (<code>pj</code>), sumando la cantidad de partidos que ha ganado, empatado y perdido:</p>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, pj <span class="op">=</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">+</span> <span class="va">pp</span><span class="op">)</span></code></pre></div>
<p>¿Qué sucedió al correr esa instrucción?:</p>
<ul>
<li>Como primer argumento de la función proveemos el dataset con el que vamos a operar, <code>datos</code>.</li>
<li>Elegimos en segundo lugar un nombre para una nueva variable, <code>pj</code> y la definimos como la suma de otras variables ya existentes.</li>
<li>El resultado es el dataset original con esta modificación y lo guardamos con el mismo nombre. Si hubiésemos elegido otro nombre, generaríamos una copia del dataset con la modificación, mientras conservamos el original sin cambios.</li>
</ul>
<p>Al editar variables, podemos elegir entre sobrescribir o no una columna existente, así como también entre sobrescribir o no el conjunto de datos de partida. Para pensar… sin ejecutarlas, responder: ¿cuál es la diferencia entre las siguientes instrucciones?</p>
<div class="sourceCode" id="cb663"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sentencia (a)</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, pj <span class="op">=</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">+</span> <span class="va">pp</span><span class="op">)</span>

<span class="co"># Sentencia (b)</span>
<span class="va">datos_modif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, pj <span class="op">=</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">+</span> <span class="va">pp</span><span class="op">)</span>

<span class="co"># Sentencia (c)</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, pg <span class="op">=</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">+</span> <span class="va">pp</span><span class="op">)</span></code></pre></div>
<p>Otras situaciones requieren que en lugar de <em>mutar</em> de la misma forma toda una columna, los cambios dependan de alguna condición que los registros verifiquen o no. Por ejemplo, agreguemos una nueva variable que indique si cada país es o no campeón del mundo, en función de los valores disponibles en la variable <code>titulos</code>. Vamos a crear una nueva columna que se llame <code>campeon</code> y tenga el valor <code>campeón</code> cuando <code>titulos &gt; 0</code> y <code>no campeón</code> en caso contrario, ayudándonos con la función <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>, la cual nos permite establecer una evaluación lógica y dos cursos de acción, en base a que esta resulte verdadera (<code>TRUE</code>) o falsa (<code>FALSE</code>).</p>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, campeon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">titulos</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"campeón"</span>, <span class="st">"no campeón"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Inspeccionamos la nueva columna, sumando una nueva función del <code>tidyverse</code>, <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code>. Sólo 8 países han ganado el mundial alguna vez (¡y Argentina es uno de ellos!):</p>
<div class="sourceCode" id="cb665"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">campeon</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  campeon        n
  &lt;chr&gt;      &lt;int&gt;
1 campeón        8
2 no campeón    72</code></pre>
<p>La función anterior es muy útil para chequear los valores guardados en atributos de tipo texto. Usémosla para inspeccionar la variable <code>continente</code>. ¿Hay algo que nos llame la atención?</p>
<div class="sourceCode" id="cb667"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 7 × 2
  continente     n
  &lt;chr&gt;      &lt;int&gt;
1 América       20
2 Asia           7
3 Europa        19
4 Europe        14
5 Oceanía        2
6 asia           5
7 África        13</code></pre>
<p>Detectamos inconsistencias en la forma de registrar los nombres de los continentes: Europa aparece en inglés y en español, Asia aparece con mayúscula y con minúscula. Debemos homogeneizar la nomenclatura para poder hacer cualquier análisis válido. En este caso, en el cual la corrección implica sólo “recodificar” categorías, podemos usar la función <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code> de forma muy sencilla. Aquellos registros con <code>"Europe"</code> en <code>continente</code> son reemplazados por <code>"Europa"</code>, y lo mismo ocurre con <code>"asia"</code>, que será reemplazado por <code>"Asia"</code>. Los otros valores quedan como estaban:</p>
<div class="sourceCode" id="cb669"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, continente <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">continente</span>, <span class="st">"Europe"</span> <span class="op">=</span> <span class="st">"Europa"</span>, <span class="st">"asia"</span> <span class="op">=</span> <span class="st">"Asia"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 5 × 2
  continente     n
  &lt;chr&gt;      &lt;int&gt;
1 América       20
2 Asia          12
3 Europa        33
4 Oceanía        2
5 África        13</code></pre>
<p>Ediciones que requieran evaluaciones lógicas más complejas pueden realizarse con la función <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>, que para cada fila del dataset realiza una evaluación lógica. Si resulta <code>TRUE</code>, devuelve el valor mencionado al lado del <code>~</code>. Si resulta <code>FALSE</code>, continúa evaluando la siguiente operación lógica.</p>
<div class="sourceCode" id="cb671"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    <span class="va">datos</span>, 
    continente <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
        <span class="va">continente</span> <span class="op">==</span> <span class="st">"Europe"</span> <span class="op">~</span> <span class="st">"Europa"</span>,
        <span class="va">continente</span> <span class="op">==</span> <span class="st">"asia"</span> <span class="op">~</span> <span class="st">"Asia"</span>,
        <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">continente</span> <span class="co"># opción por defecto</span>
        <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="alert alert-warning">
<p><strong>Ejercicio</strong>: agregar nuevas columnas en las que se muestre:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Crear una nueva variable llamada <code>puntos</code> que indique cuál es el puntaje total obtenido por cada selección a lo largo del tiempo, teniendo en cuenta que cada partido ganado aporta 3 puntos, cada partido empatado aporta 1 punto y cada partido perdido aporta 0 puntos.</p></li>
<li><p>Crear una nueva variable llamada <code>dg</code>, diferencia de goles, definida como la resta entre los goles a favor y los goles en contra.</p></li>
</ol>
<p><em>Tip</em>: en <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> podemos poner muchas modificaciones juntas, separándolas con coma.</p>
</div>
</div>
<div id="renombrar-atributos" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Renombrar atributos<a class="anchor" aria-label="anchor" href="#renombrar-atributos"><i class="fas fa-link"></i></a>
</h3>
<p>Para cambiar los nombres de una o más variables usamos la función <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>, listando los cambios con la estructura <code>nombre_nuevo = nombre_viejo</code>. Por ejemplo:</p>
<div class="sourceCode" id="cb672"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span></code></pre></div>
<pre><code># A tibble: 80 × 13
   seleccion    continente participaciones    pg    pe    pp    gf    gc titulos
   &lt;chr&gt;        &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 Brasil       América                 22    76    19    19   237   108       5
 2 Alemania     Europa                  20    68    21    23   232   130       4
 3 Argentina    América                 18    47    17    24   152   101       3
 4 Italia       Europa                  18    45    21    17   128    77       4
 5 Francia      Europa                  16    39    14    20   136    85       2
 6 Inglaterra   Europa                  16    32    22    20   104    68       1
 7 España       Europa                  16    31    17    19   108    75       1
 8 Países Bajos Europa                  11    30    14    11    96    52       0
 9 Uruguay      América                 14    25    13    21    89    76       2
10 Bélgica      Europa                  14    21    10    20    69    74       0
# ℹ 70 more rows
# ℹ 4 more variables: pj &lt;dbl&gt;, campeon &lt;chr&gt;, puntos &lt;dbl&gt;, dg &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb674"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">datos</span>, goles_favor <span class="op">=</span> <span class="va">gf</span>, goles_contra <span class="op">=</span> <span class="va">gc</span><span class="op">)</span>
<span class="va">datos</span></code></pre></div>
<pre><code># A tibble: 80 × 13
   seleccion    continente participaciones    pg    pe    pp goles_favor
   &lt;chr&gt;        &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
 1 Brasil       América                 22    76    19    19         237
 2 Alemania     Europa                  20    68    21    23         232
 3 Argentina    América                 18    47    17    24         152
 4 Italia       Europa                  18    45    21    17         128
 5 Francia      Europa                  16    39    14    20         136
 6 Inglaterra   Europa                  16    32    22    20         104
 7 España       Europa                  16    31    17    19         108
 8 Países Bajos Europa                  11    30    14    11          96
 9 Uruguay      América                 14    25    13    21          89
10 Bélgica      Europa                  14    21    10    20          69
# ℹ 70 more rows
# ℹ 6 more variables: goles_contra &lt;dbl&gt;, titulos &lt;dbl&gt;, pj &lt;dbl&gt;,
#   campeon &lt;chr&gt;, puntos &lt;dbl&gt;, dg &lt;dbl&gt;</code></pre>
</div>
<div id="unir-o-separar-columnas" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> Unir o separar columnas<a class="anchor" aria-label="anchor" href="#unir-o-separar-columnas"><i class="fas fa-link"></i></a>
</h3>
<p>En ocasiones puede ser necesario generar una nueva variable “pegando” o uniendo los datos presentes en otras. Imaginemos que tal vez necesitamos contar con una única variable textual que contenga tanto el nombre del país como el continente al que pertenece. Para esto recurrimos a la función <code><a href="https://tidyr.tidyverse.org/reference/unite.html">unite()</a></code>:</p>
<div class="sourceCode" id="cb676"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="va">datos</span>, col <span class="op">=</span> <span class="st">"pais_continente"</span>, <span class="va">seleccion</span>, <span class="va">continente</span>, sep <span class="op">=</span> <span class="st">" - "</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">datos</span></code></pre></div>
<pre><code># A tibble: 80 × 14
   pais_continente       seleccion  continente participaciones    pg    pe    pp
   &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Brasil - América      Brasil     América                 22    76    19    19
 2 Alemania - Europa     Alemania   Europa                  20    68    21    23
 3 Argentina - América   Argentina  América                 18    47    17    24
 4 Italia - Europa       Italia     Europa                  18    45    21    17
 5 Francia - Europa      Francia    Europa                  16    39    14    20
 6 Inglaterra - Europa   Inglaterra Europa                  16    32    22    20
 7 España - Europa       España     Europa                  16    31    17    19
 8 Países Bajos - Europa Países Ba… Europa                  11    30    14    11
 9 Uruguay - América     Uruguay    América                 14    25    13    21
10 Bélgica - Europa      Bélgica    Europa                  14    21    10    20
# ℹ 70 more rows
# ℹ 7 more variables: goles_favor &lt;dbl&gt;, goles_contra &lt;dbl&gt;, titulos &lt;dbl&gt;,
#   pj &lt;dbl&gt;, campeon &lt;chr&gt;, puntos &lt;dbl&gt;, dg &lt;dbl&gt;</code></pre>
<p>La opción <code>remove = FALSE</code> hace que las columnas que se usaron para unir permanezcan en el dataset luego de este cambio. El comportamiento por defecto es eliminarlas. Si lo que nos interesa es separar en dos columnas información que esté concatenada en una sola, usamos la contrapartida, <code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code>:</p>
<div class="sourceCode" id="cb678"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">datos</span>, col <span class="op">=</span> <span class="va">pais_continente</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"seleccion"</span>, <span class="st">"continente"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">" - "</span><span class="op">)</span></code></pre></div>
<p>Por defecto estas funciones utilizan como separador cualquier carácter no alfanumérico que figure en ese campo, incluidos los espacios. El argumento <code>sep</code> se utiliza para indicar el separador adecuado cuando el establecido por defecto no es adecuado. La separación se podría hacer en más de dos columnas, de ser necesario, cuando el separador elegido aparece más de una vez.</p>
</div>
<div id="filtrar-y-ordenar-registros" class="section level3" number="6.3.4">
<h3>
<span class="header-section-number">6.3.4</span> Filtrar y ordenar registros<a class="anchor" aria-label="anchor" href="#filtrar-y-ordenar-registros"><i class="fas fa-link"></i></a>
</h3>
<p>Podemos quedarnos sólo con los registros que cumplan con ciertas condiciones utilizando la función <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>:</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Una condición</span>
<span class="va">datos_america</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span> <span class="op">==</span> <span class="st">"América"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">datos_america</span><span class="op">)</span>

<span class="co"># Dos condiciones</span>
<span class="va">datos_campeones_america</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span> <span class="op">==</span> <span class="st">"América"</span>, <span class="va">campeon</span> <span class="op">==</span> <span class="st">"campeón"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">datos_campeones_america</span><span class="op">)</span>
<span class="co"># Alternativa equivalente: filter(datos, continente == "América" &amp; campeon == "si")</span>

<span class="co"># Al menos una de las primeras condiciones ("o") y la segunda</span>
<span class="va">datos_filtro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span> <span class="op">==</span> <span class="st">"América"</span> <span class="op">|</span> <span class="va">campeon</span> <span class="op">==</span> <span class="st">"campeón"</span>, <span class="va">participaciones</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">datos_filtro</span><span class="op">)</span></code></pre></div>
<p>Para ordenar los registros según el orden creciente o decreciente en una columna, podemos usar la función <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>:</p>
<div class="sourceCode" id="cb680"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Orden creciente:</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">puntos</span><span class="op">)</span>

<span class="co"># Orden decreciente:</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">datos</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">puntos</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Ordenar según más de una variable:</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">america</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">titulos</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="alert alert-warning">
<p><strong>Ejercicio</strong>: filtrar el conjunto de datos original para quedarse con los países que tengan una diferencia de goles positiva y guardar estos registros en un nuevo <em>data.frame</em> llamado <code>datos_dg_positiva</code>.</p>
</div>
</div>
<div id="seleccionar-y-reordenar-columnas" class="section level3" number="6.3.5">
<h3>
<span class="header-section-number">6.3.5</span> Seleccionar y reordenar columnas<a class="anchor" aria-label="anchor" href="#seleccionar-y-reordenar-columnas"><i class="fas fa-link"></i></a>
</h3>
<p>Podemos elegir quedarnos sólo con algunas columnas del dataset con la función <strong>select()</strong>:</p>
<div class="sourceCode" id="cb681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Elegir cuáles quedan</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">seleccion</span>, <span class="va">participaciones</span><span class="op">)</span>

<span class="co"># Elegir cuáles se van</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">datos</span>, <span class="op">-</span><span class="va">goles_favor</span>, <span class="op">-</span><span class="va">goles_contra</span><span class="op">)</span>

<span class="co"># Reordenar las columnas</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">seleccion</span>, <span class="va">campeon</span>, <span class="va">puntos</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="tuberías-o-pipes" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Tuberías o <em>pipes</em><a class="anchor" aria-label="anchor" href="#tuber%C3%ADas-o-pipes"><i class="fas fa-link"></i></a>
</h2>
<p>Hasta ahora, esto es parte de lo que hicimos con los datos de los mundiales:</p>
<div class="sourceCode" id="cb682"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Lectura del archivo</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"mundiales.txt"</span><span class="op">)</span>

<span class="co"># Calcular la cantidad total de partidos jugados en mundiales</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, pj <span class="op">=</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">+</span> <span class="va">pp</span><span class="op">)</span>

<span class="co"># Indicar si cada país es o no campeón del mundo</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, campeon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">titulos</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"campeón"</span>, <span class="st">"no campeón"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Corregir los nombres de los continentes</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, continente <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">continente</span>, <span class="st">"Europe"</span> <span class="op">=</span> <span class="st">"Europa"</span>, <span class="st">"asia"</span> <span class="op">=</span> <span class="st">"Asia"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Calcular los puntos ganados por cada país y la diferencia de goles</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, puntos <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span>, dg <span class="op">=</span> <span class="va">gf</span> <span class="op">-</span> <span class="va">gc</span><span class="op">)</span>

<span class="co"># Cambiar los nombres de algunas columnas</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">datos</span>, goles_favor <span class="op">=</span> <span class="va">gf</span>, goles_contra <span class="op">=</span> <span class="va">gc</span><span class="op">)</span>

<span class="co"># Crear una nueva variable con el nombre del país y del continente</span>
<span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="va">datos</span>, col <span class="op">=</span> <span class="st">"pais_continente"</span>, <span class="va">seleccion</span>, <span class="va">continente</span>, sep <span class="op">=</span> <span class="st">" - "</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>En todas las instrucciones anteriores se repite la misma estructura: cada función toma el dataset, lo modifica y lo guarda, y esto se convierte en el input para la próxima función. Se puede escribir todo junto de manera más cómoda usando una <strong>tubería</strong> o <strong>pipeline</strong>. En una <strong>tubería</strong> el resultado de cada línea es el input para la línea siguiente (por eso eliminamos en cada función el primer argumento, el nombre del dataset). El símbolo <code>%&gt;%</code>, conocido como <em>pipe</em>, es la unión entre las partes de la tubería<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;También podemos usar el operador &lt;code&gt;%&amp;gt;%&lt;/code&gt;.&lt;/p&gt;"><sup>27</sup></a>. El atajo para escribir este operador de forma rápida con el teclado es <code>CTRL + Shift + M</code>. El <em>data.frame</em> devuelto por la última función de la tubería es guardado en el objeto cuyo nombre se indica al comienzo.</p>
<div class="sourceCode" id="cb683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"mundiales.txt"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
        pj <span class="op">=</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span> <span class="op">+</span> <span class="va">pp</span>,
        campeon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">titulos</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"campeón"</span>, <span class="st">"no campeón"</span><span class="op">)</span>,
        continente <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">continente</span>, <span class="st">"Europe"</span> <span class="op">=</span> <span class="st">"Europa"</span>, <span class="st">"asia"</span> <span class="op">=</span> <span class="st">"Asia"</span><span class="op">)</span>,
        puntos <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">pg</span> <span class="op">+</span> <span class="va">pe</span>, 
        dg <span class="op">=</span> <span class="va">gf</span> <span class="op">-</span> <span class="va">gc</span>
    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>goles_favor <span class="op">=</span> <span class="va">gf</span>, goles_contra <span class="op">=</span> <span class="va">gc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"pais_continente"</span>, <span class="va">seleccion</span>, <span class="va">continente</span>, sep <span class="op">=</span> <span class="st">" - "</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="escritura-de-conjuntos-de-datos-en-archivos" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Escritura de conjuntos de datos en archivos<a class="anchor" aria-label="anchor" href="#escritura-de-conjuntos-de-datos-en-archivos"><i class="fas fa-link"></i></a>
</h2>
<p>Todas las modificaciones que hicimos del <em>data.frame</em> con los ejemplos anteriores no modificaron el archivo original <code>mundiales.txt</code> que reside en el disco rígido de nuestra computadora, sino que sirvieron para modificar al objeto <code>datos</code> que reside en la memoria temporal durante la ejecución de la sesión de R. Si al terminar con el procesamiento de los datos queremos generar un nuevo archivo permanente con la nueva versión del dataset, tenemos que hacer algo específico para eso. R provee una gran variedad de funciones para guardar todo el contenido de un objeto de tipo <em>data.frame</em> en un archivo, como se muestra en los ejemplos que siguen, en los que plasmamos la versión actual del <em>data.frame</em> en un nuevo archivo llamado <code>mundiales_procesado</code>. En cada ocasión, generamos un tipo de archivo distinto:</p>
<div class="sourceCode" id="cb684"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Guardarlo en un archivo de texto separado por tabulaciones</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">datos</span>, <span class="st">"mundiales_procesado.txt"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span>

<span class="co"># Guardarlo en un archivo de texto separado por comas</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">datos</span>, <span class="st">"mundiales_procesado.txt"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Guardarlo en un archivo de Excel</span>
<span class="co"># install.packages("writexl")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/writexl/">writexl</a></span><span class="op">)</span>
<span class="fu"><a href="https://docs.ropensci.org/writexl/reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">datos</span>, <span class="st">"mundiales_procesado.xlsx"</span><span class="op">)</span></code></pre></div>
</div>
<div id="resumen-de-datos" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Resumen de datos<a class="anchor" aria-label="anchor" href="#resumen-de-datos"><i class="fas fa-link"></i></a>
</h2>
<p>Una vez que los datos han sido organizados y limpiados según corresponda, el siguiente paso de cualquier análisis es hacer un breve análisis exploratorio. En esta sección veremos cómo calcular algunas estadísticas y realizar tablas de distribuciones de frecuencias, ya sea para variables categóricas o cuantitativas.</p>
<div id="cálculo-de-estadísticas" class="section level3" number="6.6.1">
<h3>
<span class="header-section-number">6.6.1</span> Cálculo de estadísticas<a class="anchor" aria-label="anchor" href="#c%C3%A1lculo-de-estad%C3%ADsticas"><i class="fas fa-link"></i></a>
</h3>
<p>Imaginemos ahora que queremos saber cuántas veces en promedio han participado estas 80 selecciones del mundial. Esto se puede lograr de manera muy sencilla con <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>:</p>
<div class="sourceCode" id="cb685"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">participaciones</span><span class="op">)</span></code></pre></div>
<pre><code>[1] 6.1125</code></pre>
<p>Otra alternativa es utilizar la función <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> del <code>tidyverse</code>:</p>
<div class="sourceCode" id="cb687"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="va">datos</span>, total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">participaciones</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  total
  &lt;dbl&gt;
1  6.11</code></pre>
<p>Si bien ésta última forma parece ser más compleja, tiene algunas ventajas:</p>
<ul>
<li>Devuelve el resultado como un objeto de tipo <em>data.frame</em>, que puede ser usado como “materia prima” en otros análisis.</li>
<li>Permite resumir muchas variables a la vez, en general o por grupos, aplicando uno o varios cálculos de resumen.</li>
</ul>
<p>Por ejemplo, si queremos obtener el puntaje promedio obtenido por las selecciones de cada continente utilizamos <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> en conjunto con <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>, relacionando ambas funciones en una tubería:</p>
<div class="sourceCode" id="cb689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">continente</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>prom_puntos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">puntos</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 5 × 2
  continente prom_puntos
  &lt;chr&gt;            &lt;dbl&gt;
1 América          38.2 
2 Asia              7.67
3 Europa           50   
4 Oceanía           9.5 
5 África           11.7 </code></pre>
<p>Podemos seguir alargando la tubería, para pedir que el resultado anterior se presente de forma descendente, de modo que veamos rápidamente cuál es el continente con mayor promedio de puntos obtenidos:</p>
<div class="sourceCode" id="cb691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">continente</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>prom_puntos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">puntos</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">prom_puntos</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 5 × 2
  continente prom_puntos
  &lt;chr&gt;            &lt;dbl&gt;
1 Europa           50   
2 América          38.2 
3 África           11.7 
4 Oceanía           9.5 
5 Asia              7.67</code></pre>
<p>Dentro de <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> podemos pedir más de un resumen:</p>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">continente</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
        prom_puntos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">puntos</span><span class="op">)</span>,      <span class="co"># promedio de los puntos de los países</span>
        min_puntos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">puntos</span><span class="op">)</span>,        <span class="co"># mínimo puntaje en ese continente</span>
        max_puntos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">puntos</span><span class="op">)</span>,        <span class="co"># máximo puntaje en ese continente</span>
        total_titulos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">titulos</span><span class="op">)</span>,    <span class="co"># mundiales ganados por países del continente</span>
        total_pj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pj</span><span class="op">)</span>,              <span class="co"># cantidad total de partidos jugados</span>
        prom_dg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dg</span><span class="op">)</span>,              <span class="co"># promedio de la diferencia de goles</span>
        n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>                          <span class="co"># cantidad de registros en cada continente</span>
    <span class="op">)</span> </code></pre></div>
<pre><code># A tibble: 5 × 8
  continente prom_puntos min_puntos max_puntos total_titulos total_pj prom_dg
  &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 América          38.2           0        247            10      534   -0.75
2 Asia              7.67          0         31             0      126  -12.4 
3 Europa           50             1        225            12     1080    8.79
4 Oceanía           9.5           3         16             0       26  -15   
5 África           11.7           0         23             0      162   -7.38
# ℹ 1 more variable: n &lt;int&gt;</code></pre>
</div>
<div id="distribuciones-de-frecuencias-para-variables-categóricas" class="section level3" number="6.6.2">
<h3>
<span class="header-section-number">6.6.2</span> Distribuciones de frecuencias para variables categóricas<a class="anchor" aria-label="anchor" href="#distribuciones-de-frecuencias-para-variables-categ%C3%B3ricas"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando en los archivos de datos existen campos de tipo carácter, que representan variables categóricas, es común resumirlos creando <strong>tablas de frecuencias</strong>. Ya vimos que la función <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> nos permite obtener la <strong>frecuencia absoluta</strong> (bajo el nombre de <code>n</code>) de cada categoría:</p>
<div class="sourceCode" id="cb695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 5 × 2
  continente     n
  &lt;chr&gt;      &lt;int&gt;
1 América       20
2 Asia          12
3 Europa        33
4 Oceanía        2
5 África        13</code></pre>
<p>Sin embargo, utilizaremos un paquete que es muy útil para generar tablas de frecuencias, llamado <code>janitor</code>. No forma parte del <code>tidyverse</code> pero está creado con el mismo diseño. Lo instalamos y cargamos:</p>
<div class="sourceCode" id="cb697"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("janitor")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></code></pre></div>
<p>Ahora usamos la función <code>tabyl</code> del paquete <code>janitor</code> para crear una tabla de frecuencias:</p>
<div class="sourceCode" id="cb698"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frecuencias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span><span class="op">)</span>
<span class="va">frecuencias</span></code></pre></div>
<pre><code> continente  n percent
    América 20  0.2500
       Asia 12  0.1500
     Europa 33  0.4125
    Oceanía  2  0.0250
     África 13  0.1625</code></pre>
<p>Lo anterior es un nuevo <em>data.frame</em> con tres variables, el continente, la frecuencia absoluta <code>n</code> y la frecuencia relativa, que si bien son proporciones que varían entre 0 y 1, el software las llama <code>percent</code>. En este caso, con pocas categorías, podemos apreciar rápidamente cuál es el continente con mayor y menor cantidad de países que participaron de mundiales, pero si queremos resaltar esta información podemos hacer algunos filtrados. A continuación, filtramos el <em>data.frame</em> <code>frecuencias</code> para retener aquellas filas donde el valor de <code>n</code> sea igual a su mínimo o a su máximo:</p>
<div class="sourceCode" id="cb700"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">minimo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">frecuencias</span>, <span class="va">n</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="va">minimo</span></code></pre></div>
<pre><code> continente n percent
    Oceanía 2   0.025</code></pre>
<div class="sourceCode" id="cb702"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maximo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">frecuencias</span>, <span class="va">n</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="va">maximo</span></code></pre></div>
<pre><code> continente  n percent
     Europa 33  0.4125</code></pre>
<p>Notemos que los objetos <code>minimo</code> y <code>maximo</code> son nuevos <em>data.frames</em>, con tan sólo una observación. Podríamos usarlos para emitir algún mensaje con los hallazgos. Por supuesto que si hubiesen empates en los valores máximos o mínimos tendríamos que pensar otra forma de comunicar el mensaje, pero con todos los conocimientos que tenemos de programación esa tarea es sencilla de resolver:</p>
<div class="sourceCode" id="cb704"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"El continente con la mayor cantidad de países que han participado de mundiales es"</span>, 
        <span class="va">maximo</span><span class="op">$</span><span class="va">continente</span>, <span class="st">"con"</span>, <span class="va">maximo</span><span class="op">$</span><span class="va">n</span>, <span class="st">"selecciones, mientras que el de menor participación es"</span>, 
        <span class="va">minimo</span><span class="op">$</span><span class="va">continente</span>, <span class="st">"con"</span>, <span class="va">minimo</span><span class="op">$</span><span class="va">n</span>, <span class="st">"selecciones."</span><span class="op">)</span></code></pre></div>
<pre><code>El continente con la mayor cantidad de países que han participado de mundiales es Europa con 33 selecciones, mientras que el de menor participación es Oceanía con 2 selecciones.</code></pre>
<p>Un aspecto útil de la función <code><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl()</a></code> es que puede ser acompañada por funciones que comienzan con el nombre <code>adorn_</code> y sirven para agregar algún tipo de “adorno” a la tabla, por ejemplo, los totales:</p>
<div class="sourceCode" id="cb706"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frecuencias</span> <span class="op">&lt;-</span> 
    <span class="va">frecuencias</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">frecuencias</span></code></pre></div>
<pre><code> continente  n percent
    América 20  0.2500
       Asia 12  0.1500
     Europa 33  0.4125
    Oceanía  2  0.0250
     África 13  0.1625
      Total 80  1.0000</code></pre>
<p>Podríamos mejorar levemente la tabla de frecuencias cambiando los nombres de sus columnas, con la función <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>. Para poder usar nombres que contengan espacios, tenemos que encerrarlos en comillas invertidas (esto es poco práctico a la hora de escribir código, sólo sirve para mejorar la apariencia del resultado):</p>
<div class="sourceCode" id="cb708"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frecuencias</span> <span class="op">&lt;-</span> 
    <span class="va">frecuencias</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Continente <span class="op">=</span> <span class="va">continente</span>, `Frec. Absoluta` <span class="op">=</span> <span class="va">n</span>, `Frec. Relativa` <span class="op">=</span> <span class="va">percent</span><span class="op">)</span>
<span class="va">frecuencias</span></code></pre></div>
<pre><code> Continente Frec. Absoluta Frec. Relativa
    América             20         0.2500
       Asia             12         0.1500
     Europa             33         0.4125
    Oceanía              2         0.0250
     África             13         0.1625
      Total             80         1.0000</code></pre>
<p>Si escribimos todos los pasos que hicimos en una sola tubería, nos quedaría así:</p>
<div class="sourceCode" id="cb710"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frecuencias</span> <span class="op">&lt;-</span> 
    <span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">continente</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Continente <span class="op">=</span> <span class="va">continente</span>, `Frec. Absoluta` <span class="op">=</span> <span class="va">n</span>, `Frec. Relativa` <span class="op">=</span> <span class="va">percent</span><span class="op">)</span>
<span class="va">frecuencias</span></code></pre></div>
<pre><code> Continente Frec. Absoluta Frec. Relativa
    América             20         0.2500
       Asia             12         0.1500
     Europa             33         0.4125
    Oceanía              2         0.0250
     África             13         0.1625
      Total             80         1.0000</code></pre>
<p>Otro tipo de escenario se presenta cuando queremos analizar las frecuencias de dos variables categóricas. La función <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> también permite obtener conteos asociados a cada combinación posible de las categorías de dos o más variables. El resultado, como siempre, es un <em>data.frame</em> con una columna para cada una de las variables involucradas y otra para las frecuencias absolutas. Así, podemos ver que de todos los países americanos que jugaron algún mundial, 17 nunca fueron campeones y 3 sí.</p>
<div class="sourceCode" id="cb712"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span>, <span class="va">campeon</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 7 × 3
  continente campeon        n
  &lt;chr&gt;      &lt;chr&gt;      &lt;int&gt;
1 Europa     no campeón    28
2 América    no campeón    17
3 África     no campeón    13
4 Asia       no campeón    12
5 Europa     campeón        5
6 América    campeón        3
7 Oceanía    no campeón     2</code></pre>
<p>Esta forma de presentar los resultados es útil cuando deseamos identificar combinaciones de categorías con los valores mínimos y máximos. Sin embargo, frecuencias como las anteriores suelen ser presentadas en <strong>tablas de contingencia</strong> o <strong>tablas de doble entrada</strong>, donde las filas se corresponden a las categorías de una variable y las columnas, a las de la otra. La función<code><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl()</a></code> presenta los conteos de esa forma:</p>
<div class="sourceCode" id="cb714"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabla_cont_campeon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">continente</span>, <span class="va">campeon</span><span class="op">)</span>
<span class="va">tabla_cont_campeon</span></code></pre></div>
<pre><code> continente campeón no campeón
     África       0         13
    América       3         17
       Asia       0         12
     Europa       5         28
    Oceanía       0          2</code></pre>
<p>Podemos destacar cuál es el continente con mayor cantidad de campeones filtrando al registro con máximo valor en la columna <code>campeón</code>:</p>
<div class="sourceCode" id="cb716"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tabla_cont_campeon</span>, <span class="va">campeón</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">campeón</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code> continente campeón no campeón
     Europa       5         28</code></pre>
<p>La función <code><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals()</a></code> nos permite de manera muy sencilla agregar totales marginales, tanto para filas como columnas:</p>
<div class="sourceCode" id="cb718"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">continente</span>, <span class="va">campeon</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span>where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code> continente campeón no campeón Total
     África       0         13    13
    América       3         17    20
       Asia       0         12    12
     Europa       5         28    33
    Oceanía       0          2     2
      Total       8         72    80</code></pre>
<p>Además, podemos pedir frecuencias relativas en lugar de absolutas, ya sea de la distribución conjunta de las dos variables (<code>denominator = all</code>), condicionada a la fila (<code>denominator = row</code>) o a la columna (<code>denominator = col</code>).</p>
<ul>
<li>
<p><strong>Distribución conjunta de las variables</strong>: podemos ver, por ejemplo, que el 3.8% de todos los países participantes son de América y han salido campeón alguna vez.</p>
<div class="sourceCode" id="cb720"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">continente</span>, <span class="va">campeon</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span>where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span>denominator <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span>  <span class="co"># cálculo de proporciones</span>
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>            <span class="co"># mostrarlas como porcentaje (opcional)</span></code></pre></div>
<pre><code> continente campeón no campeón  Total
     África    0.0%      16.2%  16.2%
    América    3.8%      21.2%  25.0%
       Asia    0.0%      15.0%  15.0%
     Europa    6.2%      35.0%  41.2%
    Oceanía    0.0%       2.5%   2.5%
      Total   10.0%      90.0% 100.0%</code></pre>
</li>
<li>
<p><strong>Distribución condicional de campeon dado continente</strong>: los porcentajes suman 1 en cada fila. De todos los países americanos que alguna vez participaron de un mundia, el 15% logró ser campeón y el 85%, no.</p>
<div class="sourceCode" id="cb722"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">continente</span>, <span class="va">campeon</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span>where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span>denominator <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code> continente campeón no campeón  Total
     África    0.0%     100.0% 100.0%
    América   15.0%      85.0% 100.0%
       Asia    0.0%     100.0% 100.0%
     Europa   15.2%      84.8% 100.0%
    Oceanía    0.0%     100.0% 100.0%
      Total   10.0%      90.0% 100.0%</code></pre>
</li>
<li>
<p><strong>Distribución condicional de continente dado campeón</strong>: los porcentajes suman 1 en cada columna. De todos los países que salieron campeones, el 62.5% son europeos y el 37.5% restante, americanos.</p>
<div class="sourceCode" id="cb724"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">continente</span>, <span class="va">campeon</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span>where <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span>denominator <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code> continente campeón no campeón
     África    0.0%      18.1%
    América   37.5%      23.6%
       Asia    0.0%      16.7%
     Europa   62.5%      38.9%
    Oceanía    0.0%       2.8%
      Total  100.0%     100.0%</code></pre>
</li>
</ul>
<p>También podemos mostrar frecuencias absolutas y relativas al mismo tiempo, así como editar los títulos. Ejemplificamos mostrando nuevamente la distribución conjunta:</p>
<div class="sourceCode" id="cb726"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">continente</span>, <span class="va">campeon</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_totals.html">adorn_totals</a></span><span class="op">(</span>where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span>denominator <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_ns.html">adorn_ns</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_title.html">adorn_title</a></span><span class="op">(</span>placement <span class="op">=</span> <span class="st">"top"</span>, <span class="st">"Continente"</span>, <span class="st">"Campeones del mundo"</span><span class="op">)</span></code></pre></div>
<pre><code>            Campeones del mundo                       
 Continente             campeón no campeón       Total
     África            0.0% (0) 16.2% (13)  16.2% (13)
    América            3.8% (3) 21.2% (17)  25.0% (20)
       Asia            0.0% (0) 15.0% (12)  15.0% (12)
     Europa            6.2% (5) 35.0% (28)  41.2% (33)
    Oceanía            0.0% (0)  2.5%  (2)   2.5%  (2)
      Total           10.0% (8) 90.0% (72) 100.0% (80)</code></pre>
</div>
<div id="distribuciones-de-frecuencias-para-variables-cuantitativas" class="section level3" number="6.6.3">
<h3>
<span class="header-section-number">6.6.3</span> Distribuciones de frecuencias para variables cuantitativas<a class="anchor" aria-label="anchor" href="#distribuciones-de-frecuencias-para-variables-cuantitativas"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando se exploran datos de variables cuantitativas, es común realizar tablas de frecuencias agrupando los valores observados en intervalos. Usando la función <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> dentro de <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> podemos especificar los puntos de corte y generar una nueva columna que informa a qué intervalo pertenece cada observación:</p>
<div class="sourceCode" id="cb728"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">datos</span>, intervalos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">goles_favor</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, <span class="fl">50</span><span class="op">)</span>, right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">seleccion</span>, <span class="va">goles_favor</span>, <span class="va">intervalos</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 80 × 3
   seleccion    goles_favor intervalos
   &lt;chr&gt;              &lt;dbl&gt; &lt;fct&gt;     
 1 Brasil               237 [200,250) 
 2 Alemania             232 [200,250) 
 3 Argentina            152 [150,200) 
 4 Italia               128 [100,150) 
 5 Francia              136 [100,150) 
 6 Inglaterra           104 [100,150) 
 7 España               108 [100,150) 
 8 Países Bajos          96 [50,100)  
 9 Uruguay               89 [50,100)  
10 Bélgica               69 [50,100)  
# ℹ 70 more rows</code></pre>
<p>Ahora podemos emplear la nueva columna <code>intervalos</code> para realizar tablas de frecuencias como vimos antes:</p>
<div class="sourceCode" id="cb730"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tabla_gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">datos</span>, <span class="va">intervalos</span><span class="op">)</span>
<span class="va">tabla_gf</span></code></pre></div>
<pre><code> intervalos  n percent
     [0,50) 63  0.7875
   [50,100) 10  0.1250
  [100,150)  4  0.0500
  [150,200)  1  0.0125
  [200,250)  2  0.0250</code></pre>
<p>Aunque lo vemos a simple vista, podemos programar la búsqueda del intervalo de valores con la mayor frecuencia y emitir un mensaje:</p>
<div class="sourceCode" id="cb732"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maximo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tabla_gf</span>, <span class="va">n</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="va">maximo</span></code></pre></div>
<pre><code> intervalos  n percent
     [0,50) 63  0.7875</code></pre>
<div class="sourceCode" id="cb734"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"El intervalo de cantidad de goles a favor con la mayor cantidad de observaciones es"</span>, 
        <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">maximo</span><span class="op">$</span><span class="va">intervalos</span><span class="op">)</span>, <span class="st">"con"</span>, <span class="va">maximo</span><span class="op">$</span><span class="va">n</span>, <span class="st">"países."</span><span class="op">)</span></code></pre></div>
<pre><code>El intervalo de cantidad de goles a favor con la mayor cantidad de observaciones es [0,50) con 63 países.</code></pre>
<p>También podemos agregar columnas de frecuencias acumuladas, como suele ser común cuando se resumen variables cuantitativas o cualitativas ordinales. Para esto usamos la función <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code>, que calcula una <em>suma acumulada</em>, es decir, cada fila tiene la suma de los valores encontrados desde la primera hasta ella inclusive. Además, aprovechamos a elegir nombres y cambiar los anteriores para que se vean mejor la impresión de la tabla:</p>
<!-- 
IDEA EJERCICIO
https://data-se.netlify.app/2021/02/24/exercises-to-data-wrangling-with-the-tidyverse/ -->
</div>
</div>
<div id="creación-de-archivos-y-escritura-de-resultados" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Creación de archivos y escritura de resultados<a class="anchor" aria-label="anchor" href="#creaci%C3%B3n-de-archivos-y-escritura-de-resultados"><i class="fas fa-link"></i></a>
</h2>
<p>Anteriormente hemos mencionado que cuando trabajamos con archivos podemos realizar acciones tanto de lectura como de escritura, aunque hasta el momento nos hemos limitado a leer registros de un archivo. En este apartado presentamos cómo crear un archivo de texto desde R, de manera que pueda utilizarse para escribir y guardar allí los resultados obtenidos.</p>
<div id="crear-un-archivo-para-guardar-resultados" class="section level3" number="6.7.1">
<h3>
<span class="header-section-number">6.7.1</span> Crear un archivo para guardar resultados<a class="anchor" aria-label="anchor" href="#crear-un-archivo-para-guardar-resultados"><i class="fas fa-link"></i></a>
</h3>
<p>Imaginemos que en el problema del hotel, en lugar de mostrar los resultados en la consola, queremos volcarlos en un archivo de texto llamado <code>resultados.txt</code>.</p>
<p>En R, la función <code><a href="https://rdrr.io/r/base/sink.html">sink()</a></code> permite escribir en un archivo de texto todos los resultados que habitualmente vemos en la consola. Sus argumentos son:</p>
<ul>
<li>
<code>file</code>: nombre del archivo, si no existe será creado. Se guarda en el directorio de trabajo actual, a menos que indiquemos aquí la ruta completa hacia otra carpeta.</li>
<li>
<code>append</code>: si el archivo ya existía, por default lo sobreescribe (borra lo anterior), a menos que indiquemos <code>append = TRUE</code> para que agregue nuevas línea sin borrar nada.</li>
<li>
<code>split</code>: por default mientras la conexión al archivo está activa, los resultados que enviamos al mismo no se muestran en la consola de R, a menos que indiquemos <code>split = TRUE</code>, en cuyo caso sucederán ambas cosas: los resultados serán escritos en el archivo y se verán en la consola.</li>
</ul>
<p>Cuando se desea cerrar la conexión al archivo, se debe correr <code><a href="https://rdrr.io/r/base/sink.html">sink()</a></code> sin ningún argumento. Todo lo que <em>imprimamos</em> con <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> entre ambos llamados a <code><a href="https://rdrr.io/r/base/sink.html">sink()</a></code> se guardará en el archivo. La última parte del código en el problema anterior debe ser:</p>
<div class="sourceCode" id="cb736"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Crear conexión al archivo de resultados y poner un encabezado</span>
<span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"salida.txt"</span>, append <span class="op">=</span> <span class="cn">TRUE</span>, split <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"==========================================\n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"            ARCHIVO DE RESULTADOS         \n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"==========================================\n\n"</span><span class="op">)</span>

<span class="co"># a) Mostrar la tabla</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Número de reservas durante el 2021 según mes y tipo de habitación\n"</span><span class="op">)</span>
<span class="va">cuadro</span>

<span class="co"># b) Determinar el total de pernoctaciones en el hotel durante el 2021</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nEl número total de pernoctaciones en el hotel durante el 2021 fue"</span>, <span class="va">pernoc</span>, <span class="st">"\n\n"</span><span class="op">)</span>

<span class="co"># c) Determinar cuál fue el mes de mayor cantidad de reservas</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">maximo</span><span class="op">(</span><span class="va">total_fila</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"El mes de mayor cantidad de reservas fue"</span>, <span class="va">meses</span><span class="op">[</span><span class="va">res</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="st">"con"</span>, 
    <span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"reservas.\n\n"</span><span class="op">)</span>

<span class="co"># d) Determinar para cada tipo de habitación el mes con menor número de reservas</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">minimo_matriz_col</span><span class="op">(</span><span class="va">tabla</span>, <span class="va">j</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Para las habitaciones de tipo"</span>, <span class="va">tipos</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, 
        <span class="st">"el mes con menor\n     número de reservas fue"</span>, 
        <span class="va">meses</span><span class="op">[</span><span class="va">res</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="st">"con"</span>, <span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"reservas.\n"</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Cerrar conexión al archivo</span>
<span class="fu"><a href="https://rdrr.io/r/base/sink.html">sink</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="lectura-opcional" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> Lectura opcional<a class="anchor" aria-label="anchor" href="#lectura-opcional"><i class="fas fa-link"></i></a>
</h2>
<div id="otros-ejemplos-para-obtener-resúmenes" class="section level3" number="6.8.1">
<h3>
<span class="header-section-number">6.8.1</span> Otros ejemplos para obtener resúmenes<a class="anchor" aria-label="anchor" href="#otros-ejemplos-para-obtener-res%C3%BAmenes"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando aplicamos el mismo tipo de resumen a varias variables (en este caso, la media), podemos usar <code>across</code>:</p>
<div class="sourceCode" id="cb737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">continente</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">goles_favor</span>, <span class="va">goles_contra</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code># A tibble: 5 × 3
  continente goles_favor goles_contra
  &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;
1 América          37.9          38.6
2 Asia              8.67         21.1
3 Europa           50.9          42.1
4 Oceanía          10.5          25.5
5 África           12.1          19.5</code></pre>
<p>Podemos aplicar el mismo tipo de resumen para todas las variables que tengan alguna característica en particular, por ejemplo, ser numéricas:</p>
<div class="sourceCode" id="cb739"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datos</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">continente</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/janitor/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="tablas-de-frecuencia-con-r-base" class="section level3" number="6.8.2">
<h3>
<span class="header-section-number">6.8.2</span> Tablas de frecuencia con R Base<a class="anchor" aria-label="anchor" href="#tablas-de-frecuencia-con-r-base"><i class="fas fa-link"></i></a>
</h3>
<p>Utilizar el paquete <code>janitor</code> no es la única forma de inspeccionar frecuencias. Se puede hacer de forma sencilla con funciones incorporadas en R Base, aunque la forma de presentar los resultados es menos vistosa:</p>
<div class="sourceCode" id="cb740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Frecuencias absolutas</span>
<span class="va">tabla1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">continente</span><span class="op">)</span>
<span class="va">tabla1</span></code></pre></div>
<pre><code>
 África América    Asia  Europa Oceanía 
     13      20      12      33       2 </code></pre>
<div class="sourceCode" id="cb742"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Frencuencias relativas</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">tabla1</span><span class="op">)</span></code></pre></div>
<pre><code>
 África América    Asia  Europa Oceanía 
 0.1625  0.2500  0.1500  0.4125  0.0250 </code></pre>
<div class="sourceCode" id="cb744"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tabla de contingencia para dos variables</span>
<span class="va">tabla2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">datos</span><span class="op">$</span><span class="va">continente</span>, <span class="va">datos</span><span class="op">$</span><span class="va">campeon</span><span class="op">)</span>
<span class="va">tabla2</span></code></pre></div>
<pre><code>         
          campeón no campeón
  África        0         13
  América       3         17
  Asia          0         12
  Europa        5         28
  Oceanía       0          2</code></pre>
<div class="sourceCode" id="cb746"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Distribución conjunta</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">tabla2</span><span class="op">)</span></code></pre></div>
<pre><code>         
          campeón no campeón
  África   0.0000     0.1625
  América  0.0375     0.2125
  Asia     0.0000     0.1500
  Europa   0.0625     0.3500
  Oceanía  0.0000     0.0250</code></pre>
<div class="sourceCode" id="cb748"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Distribución condicional de campeon dado continente</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">tabla2</span>, margin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>         
            campeón no campeón
  África  0.0000000  1.0000000
  América 0.1500000  0.8500000
  Asia    0.0000000  1.0000000
  Europa  0.1515152  0.8484848
  Oceanía 0.0000000  1.0000000</code></pre>
<div class="sourceCode" id="cb750"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Distribución condicional de continente dado campeon</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">tabla2</span>, margin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>         
             campeón no campeón
  África  0.00000000 0.18055556
  América 0.37500000 0.23611111
  Asia    0.00000000 0.16666667
  Europa  0.62500000 0.38888889
  Oceanía 0.00000000 0.02777778</code></pre>
</div>
<div id="cambiar-el-formato-de-un-data.frame" class="section level3" number="6.8.3">
<h3>
<span class="header-section-number">6.8.3</span> Cambiar el formato de un <em>data.frame</em><a class="anchor" aria-label="anchor" href="#cambiar-el-formato-de-un-data.frame"><i class="fas fa-link"></i></a>
</h3>
<p>Dependiendo de los requerimientos de los análisis que estemos realizando, es muy frecuente necesitar cambiar el formato que tienen los datos. Por ejemplo, puede ser necesario apilar columnas una debajo de otra, resultando en un dataset con más filas (más largo) y menos columnas (más angosto). La situación contraria también se puede presentar y consiste en desacoplar información concatenada en una sola columna para ubicarla en varias columnas adyacentes, resultando en una dataset con más columnas (más ancho) y menos filas (más corto). Por supuesto, estas transformaciones tienen que hacerse sin mezclar los registros:</p>
<p><strong>Formato ancho a largo</strong></p>
<p>Armemos un pequeño ejemplo de juguete para imaginar bien de qué se trata esto. Supongamos que tenemos datos con la cantidad vendida de 3 productos en distintos meses. De la siguiente forma se puede crear un <em>data.frame</em> “a mano”, sin leer los datos desde un archivo:</p>
<div class="sourceCode" id="cb752"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ejemplo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  producto <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,
  septiembre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">234</span>, <span class="fl">657</span>, <span class="fl">989</span><span class="op">)</span>,
  octubre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">841</span>, <span class="fl">621</span>, <span class="fl">589</span><span class="op">)</span>,
  noviembre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">521</span>, <span class="fl">147</span>, <span class="fl">258</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">ejemplo1</span></code></pre></div>
<pre><code>  producto septiembre octubre noviembre
1        1        234     841       521
2        2        657     621       147
3        3        989     589       258</code></pre>
<p>A ese formato le decimos “ancho” porque una misma variable (cantidad de ventas) se ubica en muchas columnas, cuyos nombres se confunden con lo que en realidad debe ser otra variable, el mes. Queremos pasarlo a un formato largo para que se vea así:</p>
<pre><code># A tibble: 9 × 3
  producto mes        ventas
     &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
1        1 septiembre    234
2        1 octubre       841
3        1 noviembre     521
4        2 septiembre    657
5        2 octubre       621
6        2 noviembre     147
7        3 septiembre    989
8        3 octubre       589
9        3 noviembre     258</code></pre>
<p>Lo logramos con la función <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>, cuyos argumentos son:</p>
<ul>
<li>
<strong>data</strong>: el dataset que vamos a modificar</li>
<li>
<strong>cols</strong>: columnas que queremos apilar (o las que no queremos apilar, si es más fácil de indicar)</li>
<li>
<strong>names_to</strong>: cómo queremos que se llame la nueva columna que contendrá los nombres de las columnas apiladas.</li>
<li>
<strong>values_to</strong>: cómo queremos que se llame la nueva columna que contendrá los valores de las columnas apiladas.</li>
</ul>
<div class="inline-figure"><img src="images/06_archivos/original-dfs-tidy.png" width="60%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb755"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ejemplo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">ejemplo1</span>, 
  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">septiembre</span>, <span class="va">octubre</span>, <span class="va">noviembre</span><span class="op">)</span>, 
  names_to <span class="op">=</span> <span class="st">"mes"</span>, 
  values_to <span class="op">=</span> <span class="st">"ventas"</span>
<span class="op">)</span>
<span class="va">ejemplo2</span></code></pre></div>
<pre><code># A tibble: 9 × 3
  producto mes        ventas
     &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
1        1 septiembre    234
2        1 octubre       841
3        1 noviembre     521
4        2 septiembre    657
5        2 octubre       621
6        2 noviembre     147
7        3 septiembre    989
8        3 octubre       589
9        3 noviembre     258</code></pre>
<p><strong>Formato largo a ancho</strong></p>
<p>A su vez, la función <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> permite pasar de <strong>formatos largos</strong> a <strong>formatos anchos</strong> (al revés de <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>):</p>
<div class="inline-figure"><img src="images/06_archivos/spread.png" width="60%" style="display: block; margin: auto;"></div>
<p>Podríamos usarlo si queremos volver a la versión original de la base. Para ello necesitamos usar estos argumentos:</p>
<ul>
<li>
<strong>data</strong>: el dataset</li>
<li>
<strong>names_from</strong>: columna que tiene los nombres de las nuevas columnas</li>
<li>
<strong>values_from</strong>: columna que tiene los valores que se distribuirán en las nuevas columnas</li>
</ul>
<div class="sourceCode" id="cb757"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">ejemplo2</span>, 
  names_from <span class="op">=</span> <span class="va">mes</span>, 
  values_from <span class="op">=</span> <span class="va">ventas</span>
<span class="op">)</span></code></pre></div>
<pre><code># A tibble: 3 × 4
  producto septiembre octubre noviembre
     &lt;int&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1        1        234     841       521
2        2        657     621       147
3        3        989     589       258</code></pre>
</div>
<div id="fusionar-varios-data.frames" class="section level3" number="6.8.4">
<h3>
<span class="header-section-number">6.8.4</span> Fusionar varios <code>data.frames</code><a class="anchor" aria-label="anchor" href="#fusionar-varios-data.frames"><i class="fas fa-link"></i></a>
</h3>
<p>Muchas veces, los análisis de datos involucran múltiples tablas o conjuntos de datos, los cuales deben combinarse para dar respuesta a las preguntas de interés.. En estos casos importan las <strong>relaciones</strong> que se establecen entre las bases, más allá de los datos individuales que contenga cada uno de ellas. <code>R</code> nos ofrece diversas alternativas, las cuales dependen del tipo de relación que deseemos establecer entre los conjuntos de datos. Para definir estas relaciones debemos establecer qué variable funcionará como <code>key</code> o clave identificadora de los casos. Esta <code>key</code> debe figurar en ambos conjuntos de datos y representar lo mismo para que tenga sentido la relación. Las fusiones pueden clasificarse en dos grupos: las que producen modificaciones en uno de los conjuntos (<em>mutating joins</em>) y las que actúan como filtros (<em>filtering joins</em>).</p>
<p><strong>Mutating Joins</strong></p>
<p>Son funciones que permiten unir conjuntos de datos, agregando en uno de ellos nuevas variables que provienen del otro, a partir las filas con <code>key</code> coincidente:</p>
<pre><code>- `left_join()`
- `right_join()`
- `inner_join()`
- `full_join()`</code></pre>
<p>Hacen una <em>mutación</em> en el sentido de que añaden columnas a uno de los conjuntos. Consideremos los siguientes conjuntos de datos, donde <em>X1</em> será la clave:</p>
<div class="sourceCode" id="cb760"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Datos1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">Datos2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span>, X3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">7</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/Tabla1.png" width="40%" style="display: block; margin: auto;"></div>
<p>Veamos los distintos tipos de <em>mutating joins</em>:</p>
<ul>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code>: esta opción devuelve un conjunto de datos que contiene todas las filas de la tabla de la izquierda, agregando las columnas de la tabla de la derecha.</p>
<div class="sourceCode" id="cb761"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DatosUnidos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">Datos1</span>, <span class="va">Datos2</span>, by <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/leftjoin.PNG" width="70%" style="display: block; margin: auto;"></div>
</li>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join()</a></code>: devuelve un conjunto de datos que contiene todas las filas de la tabla de la derecha y agrega columnas de la tabla izquierda.</p>
<div class="sourceCode" id="cb762"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DatosUnidos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join</a></span><span class="op">(</span><span class="va">Datos1</span>, <span class="va">Datos2</span>, by <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/rightjoin.PNG" width="70%" style="display: block; margin: auto;"></div>
</li>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>: devuelve un conjunto de datos con todas las columnas pero sólo para las observaciones (filas) cuyos identificadores se repiten en ambos conjuntos de datos.</p>
<div class="sourceCode" id="cb763"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DatosUnidos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">Datos1</span>, <span class="va">Datos2</span>, by <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/innerjoin.PNG" width="70%" style="display: block; margin: auto;"></div>
</li>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code>: devuelve un conjunto de datos con todas las filas y columnas, fusionando a través de la <code>key</code> para las filas coincidentes entre ambos conjuntos.</p>
<div class="sourceCode" id="cb764"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DatosUnidos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">Datos1</span>, <span class="va">Datos2</span>, by <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/fulljoin.PNG" width="70%" style="display: block; margin: auto;"></div>
</li>
</ul>
<p><strong>Filtering Joins</strong></p>
<p>Son funciones que permiten unir las observaciones de dos datasets, pero sólo afectan a las filas sin alterar las columnas o variables. Funcionan como un <strong>filtro</strong> para las observaciones de una base de datos, de acuerdo a si <em>están</em> o <em>no están</em> (según el sentido que se elija) en otra base de datos:</p>
<ul>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join()</a></code>: devuelve todas las observaciones que están en <code>Datos1</code> que también están en <code>Datos2</code>, manteniendo sólo las columnas de <code>Datos1</code>. La relación se piensa como en <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>, pero el resultado es sólo la base <code>Datos1</code> filtrada.</p>
<div class="sourceCode" id="cb765"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DatosFiltrados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">Datos1</span>, <span class="va">Datos2</span>, by <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/semijoin.PNG" width="70%" style="display: block; margin: auto;"></div>
</li>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join()</a></code>: devuelve aquellas observaciones que están en <code>Datos1</code> pero <strong>no están</strong> en <code>Datos2</code>, manteniendo las columnas de <code>Datos1</code>. Es el filtro contrario a <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join()</a></code>.</p>
<div class="sourceCode" id="cb766"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">DatosFiltrados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="va">Datos1</span>, <span class="va">Datos2</span>, by <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/antijoin.PNG" width="70%" style="display: block; margin: auto;"></div>
</li>
</ul>
<p><strong>Otros detalles sobre las keys</strong></p>
<p>Hasta ahora hemos visto ejemplos donde las columnas que se usaron como claves identificadoras tenían valores únicos, sin repetir. Si la clave identificadora está duplicada en una de las bases de datos, la relación que <code>R</code> brindará con las funciones <code>*_join()</code> será del tipo “uno a varios”:</p>
<div class="sourceCode" id="cb767"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  val_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span><span class="op">)</span>, 
  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, 
  val_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/1dupkeys.PNG" width="50%" style="display: block; margin: auto;"></div>
<p>Si ambas bases de datos tienen claves duplicadas, las funciones <code>*_join()</code> devuelven todas las combinaciones posibles:</p>
<div class="sourceCode" id="cb768"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  val_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span><span class="op">)</span>,
  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
  val_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/06_archivos/2dupkeys.PNG" width="50%" style="display: block; margin: auto;"></div>
<p>Muchas veces nos interesa que las observaciones de los conjuntos de datos se relacionen a través de más de una variable, es decir, queremos identificar a cada registro a través de más de una columna. En este caso tenemos 2 opciones:</p>
<ol style="list-style-type: decimal">
<li><p>Inventar una nueva variable identificadora (<code>key</code>) que de algún modo contenga la información de esas variables e identifique a cada observación de manera única (por ejemplo, pegar ambas columnas en una sola).</p></li>
<li><p>Indicarle directamente en <code>R</code> que la relación entre las bases de datos debe hacerse a través de varias variables. En el argumento <code>by</code> de las funciones <code>*_join()</code> ponemos el vector de variables <code>by = c(Vble1, Vble2, Vble3)</code> mediante las cuales queremos que se relacionen las bases.</p></li>
</ol>
<p>Por defecto, los conjuntos de datos se unen a través de todas las variables que llevan el mismo nombre en ambos conjuntos, lo que suele denominarse <strong>unión natural</strong>. Si usamos <code>by</code> para indicar qué columnas vinculan ambas bases, y entre las columnas no mencionadas quedan variables con el mismo nombre en los dos conjuntos, entonces estas aparecerán repetidas en el dataset resultante, con una extensión en su nombre para identificar su origen (<em>nombre_columna.x, nombre_columna.y</em>).</p>
<p>Las variables usadas como <code>key</code> podrían no tener el mismo nombre en ambos conjuntos de datos. Por ejemplo, si en Datos1 tenemos <em>DNI</em> y en Datos2 tenemos <em>Documento</em>, no es necesario renombrar estas columnas: al indicar <strong><code>by = c("DNI" = "Documento")</code></strong>, R las reconoce como la misma variable, las utilizará como clave y conservará el primer nombre (<em>DNI</em> en este ejemplo).</p>
<!-- PENDIENTE: para ejemplificar fusiones, podria preparar un archivo que tenga un lsitado de todos los paises que fueron sede del mundial, dos columnas, seleccion y cantidad de veces que fue sede, y hacer la fusion con el conjunto original -->

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="estructuras-de-datos.html"><span class="header-section-number">5</span> Estructuras de datos</a></div>
<div class="next"><a href="otros-t%C3%B3picos.html"><span class="header-section-number">7</span> Otros tópicos</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#uso-de-archivos-de-datos"><span class="header-section-number">6</span> Uso de archivos de datos</a></li>
<li>
<a class="nav-link" href="#introducci%C3%B3n"><span class="header-section-number">6.1</span> Introducción</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#registros-campos-claves-y-bases-de-datos"><span class="header-section-number">6.1.1</span> Registros, campos, claves y bases de datos</a></li>
<li><a class="nav-link" href="#organizaci%C3%B3n-de-archivos"><span class="header-section-number">6.1.2</span> Organización de archivos</a></li>
<li><a class="nav-link" href="#operaciones-sobre-archivos"><span class="header-section-number">6.1.3</span> Operaciones sobre archivos</a></li>
</ul>
</li>
<li><a class="nav-link" href="#lectura-de-los-registros-del-archivo"><span class="header-section-number">6.2</span> Lectura de los registros del archivo</a></li>
<li>
<a class="nav-link" href="#manejo-de-datos"><span class="header-section-number">6.3</span> Manejo de datos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#editar-o-crear-nuevas-variables"><span class="header-section-number">6.3.1</span> Editar o crear nuevas variables</a></li>
<li><a class="nav-link" href="#renombrar-atributos"><span class="header-section-number">6.3.2</span> Renombrar atributos</a></li>
<li><a class="nav-link" href="#unir-o-separar-columnas"><span class="header-section-number">6.3.3</span> Unir o separar columnas</a></li>
<li><a class="nav-link" href="#filtrar-y-ordenar-registros"><span class="header-section-number">6.3.4</span> Filtrar y ordenar registros</a></li>
<li><a class="nav-link" href="#seleccionar-y-reordenar-columnas"><span class="header-section-number">6.3.5</span> Seleccionar y reordenar columnas</a></li>
</ul>
</li>
<li><a class="nav-link" href="#tuber%C3%ADas-o-pipes"><span class="header-section-number">6.4</span> Tuberías o pipes</a></li>
<li><a class="nav-link" href="#escritura-de-conjuntos-de-datos-en-archivos"><span class="header-section-number">6.5</span> Escritura de conjuntos de datos en archivos</a></li>
<li>
<a class="nav-link" href="#resumen-de-datos"><span class="header-section-number">6.6</span> Resumen de datos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#c%C3%A1lculo-de-estad%C3%ADsticas"><span class="header-section-number">6.6.1</span> Cálculo de estadísticas</a></li>
<li><a class="nav-link" href="#distribuciones-de-frecuencias-para-variables-categ%C3%B3ricas"><span class="header-section-number">6.6.2</span> Distribuciones de frecuencias para variables categóricas</a></li>
<li><a class="nav-link" href="#distribuciones-de-frecuencias-para-variables-cuantitativas"><span class="header-section-number">6.6.3</span> Distribuciones de frecuencias para variables cuantitativas</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#creaci%C3%B3n-de-archivos-y-escritura-de-resultados"><span class="header-section-number">6.7</span> Creación de archivos y escritura de resultados</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#crear-un-archivo-para-guardar-resultados"><span class="header-section-number">6.7.1</span> Crear un archivo para guardar resultados</a></li></ul>
</li>
<li>
<a class="nav-link" href="#lectura-opcional"><span class="header-section-number">6.8</span> Lectura opcional</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#otros-ejemplos-para-obtener-res%C3%BAmenes"><span class="header-section-number">6.8.1</span> Otros ejemplos para obtener resúmenes</a></li>
<li><a class="nav-link" href="#tablas-de-frecuencia-con-r-base"><span class="header-section-number">6.8.2</span> Tablas de frecuencia con R Base</a></li>
<li><a class="nav-link" href="#cambiar-el-formato-de-un-data.frame"><span class="header-section-number">6.8.3</span> Cambiar el formato de un data.frame</a></li>
<li><a class="nav-link" href="#fusionar-varios-data.frames"><span class="header-section-number">6.8.4</span> Fusionar varios data.frames</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introducción a la Programación</strong>: Guía de estudio - Lic. en Estadística - FCEyE - UNR" was written by Mgs. Lic. Marcos Prunello (Prof. Tit. Ord.). It was last built on 2023-05-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
